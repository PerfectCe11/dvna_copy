rules:
  - id: react-dangerouslysetinnerhtml
    patterns:
      - pattern: dangerouslySetInnerHTML={{
      - pattern-not: dangerouslySetInnerHTML={{ __html: sanitize(...)
    message: |
      ❌ React XSS Risk: dangerouslySetInnerHTML used without sanitizer.
      Ensure content is strictly sanitized (DOMPurify or equivalent).
    severity: ERROR
    languages: [javascript, typescript]
    metadata:
      category: security
      cwe: "CWE-79"

  - id: react-innerhtml-assignment
    patterns:
      - pattern-either:
          - pattern: $OBJ.innerHTML = $X
          - pattern: $EL.innerHTML = $X
          - pattern: document.body.innerHTML = $X
          - pattern: document.getElementById(...).innerHTML = $X
    message: |
      ❌ DOM XSS Sink: innerHTML assignment detected.
    severity: ERROR
    languages: [javascript, typescript]
    metadata:
      category: security
      cwe: "CWE-79"

  - id: react-document-write
    pattern: document.write($X)
    message: |
      ❌ DOM XSS Sink: document.write() usage detected.
    severity: ERROR
    languages: [javascript, typescript]
    metadata:
      category: security
      cwe: "CWE-79"

  - id: react-eval-xss
    patterns:
      - pattern-either:
          - pattern: eval($X)
          - pattern: new Function($X)
    message: |
      ❌ XSS Risk: eval / Function constructor detected.
    severity: ERROR
    languages: [javascript, typescript]
    metadata:
      category: security
      cwe: "CWE-79"
